<!DOCTYPE html>
<html dir="ltr" lang="es">
  <head>
    <title>Etapa de Empaquetación - Rubinius</title>
  	<meta charset="UTF-8">
  	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

    <meta content='es' http-equiv='content-language'>
    <meta content='Rubinius is an implementation of the Ruby programming language. The Rubinius bytecode virtual machine is written in C++. The bytecode compiler is written in pure Ruby. The vast majority of the core library is also written in Ruby, with some supporting primitives that interact with the VM directly.' name='description'>
    <link href='/' rel='home'>
    <link href='/' rel='start'>
    <link href='/doc/es/bytecode-compiler/encoder' rel='prev' title='Etapa de Codificación'>
    <link href='/doc/es/bytecode-compiler/writer'         rel='next' title='Etapa de Escritura'>
    
    <!--[if IE]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js" type="text/javascript"></script><![endif]-->

    <link href="/stylesheets/application.css" media="screen" rel="stylesheet" />
    <link href="/stylesheets/pygments.css" media="screen" rel="stylesheet" />

    <link href="/favicon.ico"                 rel="shortcut icon"    type="image/vnd.microsoft.icon" />
    <link href="/images/apple-touch-icon.png" rel="apple-touch-icon" type="image/png" />
    <link href="/images/apple-touch-icon.png" rel="apple-touch-icon" type="image/png" sizes="72x72"   />
    <link href="/images/apple-touch-icon.png" rel="apple-touch-icon" type="image/png" sizes="114x114" />
  </head>

  <body>
    <nav id="sidebar">
  <div class="sidebar-header">
    <a href="#" class="logo">Rubinius</a>
    <div role="search">
      <input type="text" name="q" placeholder="Search docs">
    </div>
  </div>

  <div class="sidebar-nav">
    <ul>
      <li><a href="/doc/en/what-is-rubinius/">What is Rubinius?</a> </li> 
      <li><a href="/doc/en/getting-started/">Getting Started</a>
        <ul>
          <li><a href="/doc/en/getting-started/requirements/">Requirements</a> </li>
          <li><a href="/doc/en/getting-started/building/">Building</a> </li>
          <li><a href="/doc/en/getting-started/running-rubinius/">Running Rubinius</a> </li>
          <li><a href="/doc/en/getting-started/troubleshooting/">Troubleshooting</a> </li>
        </ul>
      </li>
      <li><a href="/doc/en/contributing/">Contributing</a>
        <ul>
          <li><a href="/doc/en/contributing/communication/">Communication</a> </li>
          <li><a href="/doc/en/contributing/style-guide">Style Guide</a> </li>
        </ul>
      </li>
      <li><a href="/doc/en/ruby/">Ruby</a>
        <ul>
          <li><a href="/doc/en/ruby/scripts/">Scripts</a> </li>
          <li><a href="/doc/en/ruby/methods/">Methods</a> </li>
          <li><a href="/doc/en/ruby/constants/">Constants</a> </li>
          <li><a href="/doc/en/ruby/classes-and-modules/">Classes &amp; Modules</a> </li>
          <li><a href="/doc/en/ruby/blocks-and-procs/">Blocks &amp; Procs</a> </li>
          <li><a href="/doc/en/ruby/local-variables/">Local Variables</a> </li>
          <li><a href="/doc/en/ruby/instance-variables/">Instance Variables</a> </li>
          <li><a href="/doc/en/ruby/class-variables/">Class Variables</a> </li>
          <li><a href="/doc/en/ruby/global-variables/">Global Variables</a> </li>
        </ul>
      </li>
      <li><a href="/doc/en/specs/">Specs</a>
        <ul>
          <li><a href="/doc/en/specs/rubyspec/">RubySpec</a> </li> 
          <li><a href="/doc/en/specs/compiler/">Compiler Specs</a> </li>
        </ul>
      </li>
      <li><a href="/doc/en/build-system/">Build System</a> </li>
      <li><a href="/doc/en/bootstrapping/">Bootstrapping</a> </li>
      <li><a href="/doc/en/virtual-machine/">Virtual Machine</a> 
        <ul>
          <li><a href="/doc/en/virtual-machine/instructions/">Instructions</a> </li>
          <li><a href="/doc/en/virtual-machine/custom-dispatch-logic/">Custom Dispatch Logic</a> </li>
        </ul>
      </li>
      <li><a href="/doc/en/bytecode-compiler/">Bytecode Compiler</a>
        <ul>
          <li><a href="/doc/en/bytecode-compiler/parser/">Parser Stage</a> </li>
          <li><a href="/doc/en/bytecode-compiler/ast/">AST</a> </li>
          <li><a href="/doc/en/bytecode-compiler/generator/">Generator Stage</a> </li>
          <li><a href="/doc/en/bytecode-compiler/encoder/">Encoder Stage</a> </li>
          <li><a href="/doc/en/bytecode-compiler/packager/">Packager Stage</a> </li>
          <li><a href="/doc/en/bytecode-compiler/writer/">Writer Stage</a> </li>
          <li>Printers</li>
          <li><a href="/doc/en/bytecode-compiler/transformations/">Transformations</a> </li>
          <li><a href="/doc/en/bytecode-compiler/customization/">Customizing the Pipeline</a> </li>
        </ul>
      </li>
      <li><a href="/doc/en/jit/">JIT Compiler</a> </li>
      <li><a href="/doc/en/memory-system/">Memory system</a> 
        <ul>
          <li><a href="/doc/en/memory-system/object-layout/">Object layout</a> </li>
          <li><a href="/doc/en/memory-system/garbage-collector/">Garbage collector</a> </li>
        </ul>
      </li>
      <li><a href="/doc/en/systems/">Rubinius Systems</a>
        <ul>
          <li><a href="/doc/en/systems/primitives/">Primitives</a> </li>
          <li><a href="/doc/en/systems/ffi/">FFI</a> </li>
          <li><a href="/doc/en/systems/concurrency/">Concurrency</a> </li>
          <li><a href="/doc/en/systems/io/">IO</a> </li>
          <li><a href="/doc/en/systems/c-api/">C-API</a> </li>
        </ul>
      </li>
      <li><a href="/doc/en/tools/">Tools</a>
        <ul>
          <li><a href="/doc/en/tools/debugger/">Debugger</a> </li>
          <li><a href="/doc/en/tools/profiler/">Profiler</a> </li>
          <li><a href="/doc/en/tools/memory-analysis/">Memory Analysis</a> </li>
        </ul>
      </li>
      <li><a href="/doc/en/guides/">Guides</a>
        <ul>
          <li><a href="/doc/en/guides/migrating-from-mri-to-rubinius/">Migrating from MRI to Rubinius</a> </li>
        </ul>
      </li>
      <li><a href="/doc/en/how-to/">How-To</a>
        <ul>
          <li><a href="/doc/en/how-to/write-a-ticket/">Write a Ticket</a> </li>
          <li><a href="/doc/en/how-to/write-a-ruby-spec/">Write a Ruby Spec</a> </li>
          <li><a href="/doc/en/how-to/fix-a-failing-spec/">Fix a Failing Spec</a> </li>
          <li><a href="/doc/en/how-to/write-benchmarks/">Write Benchmarks</a> </li>
          <li><a href="/doc/en/how-to/write-a-blog-post/">Write a Blog Post</a> </li>
          <li><a href="/doc/en/how-to/write-documentation/">Write Documentation</a> </li>
          <li><a href="/doc/en/how-to/translate-documentation/">Translate Documentation</a> </li>
          <li><a href="/doc/en/how-to/commit-to-github/">Commit to Github</a> </li>
        </ul>
      </li>
      <li><a href="/doc/en/appendix-a-glossary/">Appendix A - Glossary</a> </li>
      <li><a href="/doc/en/appendix-b-reading-list/">Appendix B - Reading List</a> </li>
      <li><a href="/doc/en/index-of-terms/">Index of Terms</a> </li>
      <li><a href="/doc/en/frequently-asked-questions/">Frequently Asked Questions</a> </li>
    </ul>
  </div>

  <div class="sidebar-footer">
    <ul>
  
  
  
  <li><a href="/doc/de/bytecode-compiler/packager/"
    
    >de</a></li>
  
  
  
  <li><a href="/doc/en/bytecode-compiler/packager/"
    
    >en</a></li>
  
  
  
  <li><a href="/doc/es/bytecode-compiler/packager/"
    
    class="current"
    
    >es</a></li>
  
  
  
  <li><a href="/doc/fr/bytecode-compiler/packager/"
    
    >fr</a></li>
  
  
  
  <li><a href="/doc/it/bytecode-compiler/packager/"
    
    >it</a></li>
  
  
  
  <li><a href="/doc/ja/bytecode-compiler/packager/"
    
    >ja</a></li>
  
  
  
  <li><a href="/doc/pl/bytecode-compiler/packager/"
    
    >pl</a></li>
  
  
  
  <li><a href="/doc/pt-br/bytecode-compiler/packager/"
    
    >pt-br</a></li>
  
  
  
  <li><a href="/doc/ru/bytecode-compiler/packager/"
    
    >ru</a></li>
  
</ul>

    <div class="social">
      <div class="icons">
        <a href="http://twitter.com/rubinius" class="twitter">@rubinius</a>
        <a href="http://github.com/rubinius" class="github">github</a>
      </div>
      <div class="version">
        <a href="https://github.com/rubinius/rubinius/releases/tag/v2.2.10">v2.2.10</a>
      </div>
    </div>
  </div>
</nav>


<div class="container documentation">
  <h2>Etapa de Empaquetación</h2>

  

  

    <p>Una vez que el generador ha sido correctamente codificado en la etapa de
Codificación, Rubinius empaqueta el bytecode creando un nuevo método compilado
(un objeto CompiledCode) con ciertos atributos.</p>

<p>Estos atributos están expuestos en cualquier CompiledCode. Es posible
extraer un CompiledCode a partir de un método de Ruby llamando <code>executable</code>
sobre el método.</p>

<ul>
<li><em>iseq</em>: un objeto Tuple con la secuencia de instrucciones</li>
<li><em>literals</em>: un objeto Tuple con los literales utilizados en el método. Los
literales se utilizan internamente por Rubinius para valores como Strings,
y las instrucciones que los manipulan son <code>push_literal</code> y <code>set_literal</code>.</li>
<li><em>lines</em>: un Array que contiene el primer puntero de instrucción para cada
línea representada en el bytecode</li>
<li><em>required_args</em>: el número de argumentos requerido por el método</li>
<li><em>total_args</em>: el número total de argumentos, incluyendo argumentos
opcionales exceptuando <code>*args</code></li>
<li><em>splat</em>: la posición del argumento splat, si existe</li>
<li><em>local_count</em>: el número de variables locales, incluyendo parámetros</li>
<li><em>local_names</em>: un objeto Tuple con una lista de nombres de todas las
variables locales. Los primeros nombres serán los argumentos requeridos,
opcionales, splat y de bloque, en ese orden exactamente.</li>
<li><em>file</em> el nombre del fichero que se utilizará en los stack traces y otra
información de debugging.</li>
<li><em>name</em>: el nombre del método</li>
<li><em>primitive</em>: el nombre de la primitiva asociada a este método, si es que hay</li>
<li>metadatos: es posible almacenar metadatos adicionales en un método
compilado. Éste tiene un metadato llamado <code>for_block</code> con el valor <code>true</code> si
el generador original fue creado para un bloque.</li>
</ul>


<p>La etapa de Empaquetación se encarga también de que cualquier generador hijo
(como por ejemplo los generadores para bloques o métodos) también sean
convertidos en métodos compilados. Estos métodos compilados hijos se incluyen
en la tupla de literales del método compilado padre.</p>

<p>Después de que el Generator ha terminado de empaquetarse a sí mismo como un
CompiledCode, invoca la etapa de Escritura, con el CompiledCode como
entrada.</p>

<h2>Ficheros mencionados</h2>

<ul>
<li><em>kernel/bootstrap/compiled_code.rb</em>: la implementación básica de
CompiledCode, básicamente compuesta de diversas primitivas</li>
<li><em>kernel/common/compiled_code.rb</em>: una implementación más robusta de
CompiledCode, una combinación de métodos primitivos y métodos escritos en
Ruby</li>
<li><em>vm/builtin/compiledcode.cpp</em>: la implementación en C++ de las primitivas
de un CompiledCode</li>
<li><em>lib/compiler/generator.rb</em>: La implementación del método <code>package</code>, el cual
popula el CompiledCode con información sobre el objeto Generator.</li>
</ul>


<h2>Personalización</h2>

<p>En general, el método <code>package</code> está diseñado para popular el CompiledCode
con un grupo de variables. Sin embargo, también se podría utilizar el
empaquetador para popular otro objeto con la misma interfaz. A pesar de todo,
esto podría no ser útil en sí mismo sin otras personalizaciones más adelante.</p>


</div>


    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <script src="/javascripts/jquery-1.3.2.js"></script>
    <script src="/javascripts/paging_keys.js"></script>
    
    <script src="/javascripts/application.js"></script>
  </body>
</html>
